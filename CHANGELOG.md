# Changelog

Все важные изменения в проекте CyFishON будут документированы в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
и этот проект следует [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

## [1.0.7] - 2025-06-09

### Добавлено
- Интерактивная карта с отображением всех поимок
- CompassService для работы с компасом и определения направления
- MapWidgets с кастомными элементами карты
- Маркеры поимок с цветовой кодировкой (FishON-зеленый, Double-синий, Triple-красный)
- Отображение текущего местоположения с треугольником направления
- Интерактивные хинты при клике на маркеры с автоскрытием через 3 секунды
- Информационная панель с количеством поимок и направлением компаса
- Кнопка центрирования на текущем местоположении
- Ограничение области карты районом Кипра + 30 морских миль
- Защита от спама на серверном API (не более 1 поимки в 10 секунд)
- Поле `is_synced_from_server` для отслеживания источника поимок
- Статус 'spam' для блокированных поимок
- Разрешения геолокации для iOS (NSLocationWhenInUseUsageDescription)

### Исправлено
- Поимки с сервера больше не отправляются в Telegram и на сервер
- Правильное отображение статусов синхронизации
- Обновлена версия базы данных до 2 с автоматической миграцией
- Исправлена логика синхронизации - только собственные поимки отправляются

### Изменено
- Обновлен серверный API с проверкой временных интервалов
- Добавлена обработка HTTP 429 ошибок в клиенте
- Улучшена система логирования для отладки спама
- Обновлены зависимости: flutter_map ^6.1.0, latlong2 ^0.9.1, flutter_compass ^0.8.1

### Техническое
- Использует локальную синхронизированную базу данных для быстрой загрузки карты
- OpenStreetMap через flutter_map для отображения карты
- Реальное время обновления GPS и компаса
- APK оптимизирован и готов к установке на Android устройства

## [1.0.0] - 2025-01-09

### Added
- Создана базовая архитектура приложения с модульной структурой
- Реализован офлайн-first подход для работы без интернета
- Добавлены основные сервисы:
  - LocationService - работа с GPS координатами
  - TelegramService - отправка сообщений в Telegram
  - DatabaseService - локальная SQLite база данных
  - SyncService - фоновая синхронизация
  - LogService - система логирования
- Созданы все экраны приложения:
  - SplashScreen - экран загрузки
  - NameInputScreen - ввод имени при первом запуске
  - HomeScreen - главный экран с кнопками поимок
  - HistoryScreen - история поимок с фильтрацией
  - MapScreen - заглушка для карты (будущая разработка)
  - LogsScreen - просмотр логов с фильтрацией
  - SettingsScreen - настройки приложения
- Реализованы модели данных:
  - CatchRecord - модель записи о поимке
  - LogEntry - модель записи лога
- Добавлена система навигации с нижней панелью
- Настроена конфигурация приложения в AppConfig
- Создана полная документация проекта:
  - README.md - общее описание
  - PROJECT_RULES.md - правила разработки
  - docs/PROJECT_OVERVIEW.md - техническое описание
  - docs/ARCHITECTURE.md - архитектура приложения
- Настроены правила разработки и требования к документации

### Features
- Три типа поимок: FishON, Double, Triple EPTA
- Автоматическое получение GPS координат с форматированием
- Отправка сообщений в Telegram группу через Bot API
- Локальное сохранение всех поимок в SQLite
- Автоматическая синхронизация при появлении интернета
- Система повторных попыток отправки
- Отображение последних 3 поимок на главном экране
- Фильтрация истории поимок (все/только мои)
- Детальное логирование всех действий
- Настройка интервала повторных попыток
- Статистика поимок в настройках
- Индикаторы статуса отправки (зеленый/оранжевый)

### Technical
- Flutter SDK 3.5.4+
- Поддержка Android и iOS
- Офлайн-first архитектура
- SQLite для локального хранения
- Telegram Bot API для отправки сообщений
- Автоматическая синхронизация в фоне
- Система логирования с уровнями
- Модульная структура для легкого расширения

### Configuration
- Telegram Bot Token: 8017367144:AAEO257fAdCJ_ghankGbx0WVX2RZklQiwqE
- Telegram Group ID: -4881811622
- Таймаут отправки: 10 секунд
- Интервал синхронизации: 10 секунд
- Интервал повторных попыток: 5 минут (настраивается)
- Максимальная длина имени: 13 символов
- Хранение логов: 30 дней

### Fixed
- Исправлены предупреждения анализатора кода
- Удалены неиспользуемые импорты
- Исправлен базовый тест приложения
